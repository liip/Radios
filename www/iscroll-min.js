(function(){function b(g,d){this.element=typeof g=="object"?g:document.getElementById(g);this.wrapper=this.element.parentNode;var f="-webkit-transition-property:-webkit-transform;-webkit-transition-timing-function:cubic-bezier(0,0,0.25,1);-webkit-transition-duration:0;-webkit-transform:"+(a?"translate3d(0,0,0)":"translate(0,0)");this.element.setAttribute("style",f);this.options={bounce:a,momentum:a,checkDOMChanges:true,topOnDOMChanges:false,hScrollBar:a,vScrollBar:a,scrollbarClass:null,overflow:"auto",};if(typeof d=="object"){for(var e in d){this.options[e]=d[e]}}this.wrapper.style.overflow=this.options.overflow;this.refresh();window.addEventListener("resize",this,false);this.element.addEventListener("touchstart",this,false);if(this.options.checkDOMChanges){this.element.addEventListener("DOMSubtreeModified",this,false)}}b.prototype={x:0,y:0,residual:null,resetTimeout:null,handleEvent:function(d){switch(d.type){case"touchstart":this.touchStart(d);break;case"touchmove":this.touchMove(d);break;case"touchend":this.touchEnd(d);break;case"webkitTransitionEnd":this.transitionEnd(d);break;case"resize":case"orientationchange":this.refresh();break;case"DOMSubtreeModified":this.onDOMModified(d);break}},onDOMModified:function(d){this.refresh();if(this.options.topOnDOMChanges&&(this.x!=0||this.y!=0)){this.scrollTo(0,0,"0")}},refresh:function(){this.scrollWidth=this.wrapper.clientWidth;this.scrollHeight=this.wrapper.clientHeight;this.maxScrollX=this.scrollWidth-this.element.offsetWidth;this.maxScrollY=this.scrollHeight-this.element.offsetHeight;var e=this.x,d=this.y;if(this.scrollX){if(this.maxScrollX>=0){e=0}else{if(this.x<this.maxScrollX){e=this.maxScrollX}}}if(this.scrollY){if(this.maxScrollY>=0){d=0}else{if(this.y<this.maxScrollY){d=this.maxScrollY}}}if(e!=this.x||d!=this.y){this.setTransitionTime("0");this.setPosition(e,d,true)}this.scrollX=this.element.offsetWidth>this.scrollWidth?true:false;this.scrollY=this.element.offsetHeight>this.scrollHeight?true:false;if(this.options.hScrollBar&&this.scrollX){this.scrollBarX=(this.scrollBarX instanceof c)?this.scrollBarX:new c("horizontal",this.wrapper,this.options.scrollbarClass);this.scrollBarX.init(this.scrollWidth,this.element.offsetWidth)}else{if(this.scrollBarX){this.scrollBarX=this.scrollBarX.remove()}}if(this.options.vScrollBar&&this.scrollY){this.scrollBarY=(this.scrollBarY instanceof c)?this.scrollBarY:new c("vertical",this.wrapper,this.options.scrollbarClass);this.scrollBarY.init(this.scrollHeight,this.element.offsetHeight)}else{if(this.scrollBarY){this.scrollBarY=this.scrollBarY.remove()}}},setPosition:function(d,f,e){this.x=d;this.y=f;this.element.style.webkitTransform=a?"translate3d("+this.x+"px,"+this.y+"px,0px)":"translate("+this.x+"px,"+this.y+"px)";if(!e){if(this.scrollBarX){this.scrollBarX.setPosition(this.x)}if(this.scrollBarY){this.scrollBarY.setPosition(this.y)}}},setTransitionTime:function(d){d=d||"0";this.element.style.webkitTransitionDuration=d;if(this.scrollBarX){this.scrollBarX.bar.style.webkitTransitionDuration=d+(a?",300ms":"")}if(this.scrollBarY){this.scrollBarY.bar.style.webkitTransitionDuration=d+(a?",300ms":"")}},touchStart:function(f){f.preventDefault();f.stopPropagation();this.setTransitionTime();if(this.options.momentum){var d=new WebKitCSSMatrix(window.getComputedStyle(this.element).webkitTransform);if(d.e!=this.x||d.f!=this.y){this.element.removeEventListener("webkitTransitionEnd",this,false);this.setPosition(d.e,d.f)}}this.touchStartX=f.touches[0].pageX;this.scrollStartX=this.x;this.touchStartY=f.touches[0].pageY;this.scrollStartY=this.y;this.scrollStartTime=f.timeStamp;this.moved=false;this.element.addEventListener("touchmove",this,false);this.element.addEventListener("touchend",this,false)},touchMove:function(h){var f=this.scrollX===true?h.touches[0].pageX-this.touchStartX:0,d=this.scrollY===true?h.touches[0].pageY-this.touchStartY:0,i=this.x+f,g=this.y+d;this.touchStartX=h.touches[0].pageX;this.touchStartY=h.touches[0].pageY;this.moved=true;if(i>0||i<this.maxScrollX){i=this.options.bounce?Math.round(this.x+f/3):this.x}if(g>0||g<this.maxScrollY){g=this.options.bounce?Math.round(this.y+d/3):this.y}this.setPosition(i,g)},touchEnd:function(k){this.element.removeEventListener("touchmove",this,false);this.element.removeEventListener("touchend",this,false);var h=k.timeStamp-this.scrollStartTime;if(!this.moved){this.resetPosition();var l=k.changedTouches[0].target;while(l.nodeType!=1){l=l.parentNode}var m=document.createEvent("MouseEvents");m.initMouseEvent("click",true,true,k.view,1,l.screenX,l.screenY,l.clientX,l.clientY,k.ctrlKey,k.altKey,k.shiftKey,k.metaKey,0,null);l.dispatchEvent(m);return false}if(!this.options.momentum||h>250){this.resetPosition();return false}var f=this.scrollX===true?this.momentum(this.x-this.scrollStartX,h,this.options.bounce?-this.x+this.scrollWidth/3:-this.x,this.options.bounce?this.x+this.element.offsetWidth-this.scrollWidth+this.scrollWidth/3:this.x+this.element.offsetWidth-this.scrollWidth):{dist:0,time:0};var d=this.scrollY===true?this.momentum(this.y-this.scrollStartY,h,this.options.bounce?-this.y+this.scrollHeight/3:-this.y,this.options.bounce?this.y+this.element.offsetHeight-this.scrollHeight+this.scrollHeight/3:this.y+this.element.offsetHeight-this.scrollHeight):{dist:0,time:0};if(!f.dist&&!d.dist){this.resetPosition();return false}var g=Math.max(Math.max(f.time,d.time),1);var j=this.x+f.dist;var i=this.y+d.dist;this.scrollTo(j,i,g+"ms")},transitionEnd:function(){this.element.removeEventListener("webkitTransitionEnd",this,false);this.resetPosition()},resetPosition:function(f){var g=this.x,e=this.y,d=this,f=f||"500ms";if(this.x>=0){g=0}else{if(this.x<this.maxScrollX){g=this.maxScrollX}}if(this.y>=0){e=0}else{if(this.y<this.maxScrollY){e=this.maxScrollY}}if(g!=this.x||e!=this.y){this.scrollTo(g,e,f)}else{if(this.scrollBarX||this.scrollBarY){if(this.scrollBarX){this.scrollBarX.hide()}if(this.scrollBarY){this.scrollBarY.hide()}}}},scrollTo:function(e,d,f){this.element.addEventListener("webkitTransitionEnd",this,false);this.setTransitionTime(f||"450ms");this.setPosition(e,d)},momentum:function(k,e,i,d){var h=2.5,j=1.2,f=Math.abs(k)/e*1000,g=f*f/h/1000,l=0;if(k>0&&g>i){f=f*i/g/h;g=i}if(k<0&&g>d){f=f*d/g/h;g=d}g=g*(k<0?-1:1);l=f/j;return{dist:Math.round(g),time:Math.round(l)}}};var c=function(d,g,f){this.dir=d;this.bar=document.createElement("div");var e="position:absolute;-webkit-transition-timing-function:cubic-bezier(0,0,0.25,1);pointer-events:none;opacity:0;"+(a?"-webkit-transition-duration:0,300ms;-webkit-transition-delay:0,0;-webkit-transition-property:-webkit-transform,opacity;-webkit-transform:translate3d(0,0,0);":"-webkit-transition-duration:0;-webkit-transition-property:webkit-transform;-webkit-transform:translate(0,0);")+(this.dir=="horizontal"?"bottom:2px;left:1px":"top:1px;right:2px");if(f){this.bar.className=f+" "+d}else{e+=";z-index:10;background:rgba(0,0,0,0.5);"+(d=="horizontal"?"-webkit-border-radius:3px 2px;min-width:6px;min-height:5px":"-webkit-border-radius:2px 3px;min-width:5px;min-height:6px")}this.bar.setAttribute("style",e);g.appendChild(this.bar)};c.prototype={init:function(d,e){var f=this.dir=="horizontal"?this.bar.offsetWidth-this.bar.clientWidth:this.bar.offsetHeight-this.bar.clientHeight;this.maxSize=d-8;this.size=Math.round(this.maxSize*this.maxSize/e)+f;this.maxScroll=this.maxSize-this.size;this.toWrapperProp=this.maxScroll/(d-e);this.bar.style[this.dir=="horizontal"?"width":"height"]=(this.size-f)+"px"},setPosition:function(e,d){if(!d&&this.bar.style.opacity!="1"){this.show()}e=this.toWrapperProp*e;if(e<0){e=0}else{if(e>this.maxScroll){e=this.maxScroll}}if(a){e=this.dir=="horizontal"?"translate3d("+Math.round(e)+"px,0,0)":"translate3d(0,"+Math.round(e)+"px,0)"}else{e=this.dir=="horizontal"?"translate("+Math.round(e)+"px,0)":"translate(0,"+Math.round(e)+"px)"}this.bar.style.webkitTransform=e},show:function(){if(a){this.bar.style.webkitTransitionDelay="0,0"}this.bar.style.opacity="1"},hide:function(){if(a){this.bar.style.webkitTransitionDelay="0,200ms"}this.bar.style.opacity="0"},remove:function(){this.bar.parentNode.removeChild(this.bar);return null}};var a=("m11" in new WebKitCSSMatrix());window.iScroll=b})();

